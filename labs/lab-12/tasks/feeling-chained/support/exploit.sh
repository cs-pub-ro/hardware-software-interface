#!/bin/bash
# SPDX-License-Identifier: BSD-3-Clause

# TODO: Set the correct padding length

padding_length=""

# TODO: Find gadget addresses using objdump (little-endian format)

pop_rdi=""
pop_rsi=""

# TODO: Find function addresses

f1_addr=""
f3_addr=""

# TODO: Set parameter values (64-bit little-endian)

val_56=""
val_13=""

# Build ROP chain payload
# Note: Gadgets like "pop rdi; pop rbp; ret" require dummy values after parameters

payload=""
payload+=$(yes "A" | head -n "$padding_length" | paste -sd "")
payload+="$pop_rdi"
payload+="$val_56"
payload+="$pop_rsi"
payload+="$val_13"
payload+="$f1_addr"
payload+="$pop_rdi"
payload+="$val_13"
payload+="$f3_addr"

# print payload to stdout

echo -ne "$payload"
